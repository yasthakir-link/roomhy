# MongoDB Atlas Integration - Quick Reference Card

## ğŸ¯ What You Got

| Component | Location | Purpose |
|-----------|----------|---------|
| **KYCVerification Model** | `roomhy-backend/models/KYCVerification.js` | User signup data schema |
| **API Routes** | `roomhy-backend/routes/dataSync.js` | REST endpoints (20+ endpoints) |
| **Sync Tool** | `Areamanager/sync-to-mongodb.html` | Visual sync interface |
| **Server Integration** | `server.js` | Route registration |

---

## âš¡ 5-Minute Setup

```
1. Create Atlas Account
   https://mongodb.com/cloud/atlas â†’ Sign Up â†’ Create M0 Cluster

2. Create User
   Database Access â†’ Add User â†’ Username: roomhy_user â†’ Password: (your choice)

3. Allow Network
   Network Access â†’ Add IP â†’ Allow Access from Anywhere

4. Get Connection String
   Database â†’ Connect â†’ Copy Connection String
   Example: mongodb+srv://roomhy_user:PASSWORD@cluster0.xxxxx.mongodb.net/roomhy

5. Update .env
   MONGO_URI=mongodb+srv://roomhy_user:PASSWORD@cluster0.xxxxx.mongodb.net/roomhy

6. Restart Server
   npm run dev â†’ See "MongoDB Connected" in console

7. Open Sync Tool
   http://localhost:5000/Areamanager/sync-to-mongodb.html

8. Click "Sync Everything"
   Done! âœ… Data in MongoDB!
```

---

## ğŸ”— Important URLs

| Purpose | URL |
|---------|-----|
| **MongoDB Atlas** | https://atlas.mongodb.com |
| **Sync Tool** | http://localhost:5000/Areamanager/sync-to-mongodb.html |
| **Visual Guide** | http://localhost:5000/Areamanager/mongodb-integration-visual.html |
| **API Base** | http://localhost:5000/api/data |

---

## ğŸ“¡ API Endpoints Cheat Sheet

### Booking Requests
```
GET    /api/data/booking-requests           # Get all
POST   /api/data/booking-requests/sync      # Bulk sync
```

### KYC Records
```
GET    /api/data/kyc-verifications          # Get all
POST   /api/data/kyc-verifications/sync     # Bulk sync
```

### Bulk Sync
```
POST   /api/data/sync-all                   # Sync everything
```

---

## ğŸ—‚ï¸ Collections & Fields

### bookingrequests
```
property_id, property_name, area, property_type, rent_amount
user_id, name, phone, email, area_manager_id
request_type, bid_amount, message
status (pending|confirmed|rejected|booked)
visit_type, visit_date, visit_time_slot, visit_status
created_at, updated_at
```

### kycverifications
```
id, email, phone, firstName, lastName, password
role (propertyowner|tenant|admin)
kycStatus (pending|verified|rejected|expired)
status (active|inactive|blocked)
area, aadhaarNumber, panNumber
createdAt, updatedAt
```

---

## ğŸ§ª Test Commands

```bash
# Check server running
curl http://localhost:5000/api/data/booking-requests

# Get all bookings
curl http://localhost:5000/api/data/booking-requests

# Get all users
curl http://localhost:5000/api/data/kyc-verifications

# Filter by area
curl "http://localhost:5000/api/data/booking-requests?area=Kota"

# Filter by status
curl "http://localhost:5000/api/data/booking-requests?status=pending"
```

---

## âœ… Verification Checklist

- [ ] Created MongoDB Atlas account
- [ ] Created M0 Free Cluster
- [ ] Created database user (roomhy_user)
- [ ] Allowed network access
- [ ] Copied connection string
- [ ] Added MONGO_URI to .env
- [ ] Restarted server (npm run dev)
- [ ] See "MongoDB Connected" in console
- [ ] Opened sync tool in browser
- [ ] Generated test data (test-booking-data.html)
- [ ] Clicked "Sync Everything"
- [ ] Saw success message
- [ ] Checked Collections in MongoDB Atlas
- [ ] See bookingrequests and kycverifications

---

## ğŸš¨ Common Issues & Quick Fixes

| Issue | Fix |
|-------|-----|
| Cannot connect to server | Run `npm run dev` |
| MongoDB connection failed | Check `.env` has correct MONGO_URI |
| "No data to sync" | Generate test data first |
| Wrong connection string | Copy from MongoDB Atlas â†’ Database â†’ Connect |
| Timeout error | Increase network timeout in .env |

---

## ğŸ“ Quick Links

- **Setup Guide:** `MONGODB_QUICK_SETUP.md`
- **Detailed Guide:** `MONGODB_ATLAS_SETUP.md`
- **Visual Guide:** `Areamanager/mongodb-integration-visual.html`
- **Complete Docs:** `MONGODB_INTEGRATION_COMPLETE.md`

---

## ğŸ¯ Your Data Flow

```
Browser (localStorage)
    â†“ [Sync Tool Click]
API (/api/data/sync-all)
    â†“ [Validation]
Node.js Server
    â†“ [Transform]
MongoDB Driver
    â†“ [Upload]
MongoDB Atlas Cloud â˜ï¸
    â†“ [Persistent Storage]
Safe âœ… Secure âœ… Scalable âœ…
```

---

## ğŸ” Security Notes

- âœ… Passwords hashed before storage
- âœ… MongoDB Atlas handles authentication
- âœ… Network access controlled
- âœ… .env not in git
- âœ… API validation enabled

---

## ğŸ’¡ Pro Tips

1. **Backup:** MongoDB Atlas auto-backups daily (free tier)
2. **Monitoring:** Use MongoDB Atlas dashboard to monitor data
3. **Growth:** Start free, upgrade anytime when you grow
4. **Multiple Clusters:** Create separate clusters for dev/prod
5. **Indexes:** Automatic on frequently queried fields

---

## ğŸ“Š Data Stats

After syncing you'll have:
- **bookingrequests:** One document per booking request
- **kycverifications:** One document per user signup
- **Auto-indexes:** On email, phone, area, user_id, property_id
- **Auto-timestamps:** created_at, updated_at fields

---

## ğŸ“ Learning Resources

- MongoDB Atlas: https://docs.atlas.mongodb.com/
- Node.js + MongoDB: https://docs.mongodb.com/drivers/node/
- Mongoose: https://mongoosejs.com/
- Your API Routes: `roomhy-backend/routes/dataSync.js`

---

## ğŸš€ Next Steps After Sync

1. **Verify Data** - Check MongoDB Atlas Collections
2. **Test APIs** - Use curl or Postman to query
3. **Update Frontend** (optional) - Use APIs instead of localStorage
4. **Monitor** - Watch MongoDB Atlas dashboard
5. **Scale** - Add more data as needed

---

**Status:** âœ… Ready to Use  
**Time to Setup:** ~5 minutes  
**Data Backup:** Automatic  
**Cost:** FREE (M0 cluster)  

ğŸ‰ **Your data is now in the cloud!**

---

*Keep this card handy for quick reference!*
