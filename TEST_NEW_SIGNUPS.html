<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test New Signups Functionality</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-2xl mx-auto">
        <h1 class="text-3xl font-bold mb-6">New Signups Test Helper</h1>
        
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-xl font-bold mb-4">Create Test Signup Data</h2>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2">First Name</label>
                    <input type="text" id="firstName" placeholder="John" class="w-full px-3 py-2 border rounded-lg" value="John">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Last Name</label>
                    <input type="text" id="lastName" placeholder="Doe" class="w-full px-3 py-2 border rounded-lg" value="Doe">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Email</label>
                    <input type="email" id="email" placeholder="john@example.com" class="w-full px-3 py-2 border rounded-lg" value="john@example.com">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Phone</label>
                    <input type="text" id="phone" placeholder="+91 9876543210" class="w-full px-3 py-2 border rounded-lg" value="+91 9876543210">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Password</label>
                    <input type="password" id="password" placeholder="password123" class="w-full px-3 py-2 border rounded-lg" value="password123">
                </div>
                
                <button onclick="createTestSignup()" class="w-full bg-blue-600 text-white py-2 rounded-lg font-medium hover:bg-blue-700">
                    Add Test Signup
                </button>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-xl font-bold mb-4">View Stored Signups</h2>
            <button onclick="viewSignups()" class="w-full bg-purple-600 text-white py-2 rounded-lg font-medium hover:bg-purple-700 mb-4">
                View All Signups in localStorage
            </button>
            <pre id="signupsList" class="bg-gray-900 text-green-400 p-4 rounded text-xs overflow-x-auto"></pre>
        </div>

        <div class="bg-white rounded-lg shadow p-6">
            <h2 class="text-xl font-bold mb-4">Quick Actions</h2>
            <div class="space-y-2">
                <button onclick="clearAllSignups()" class="w-full bg-red-600 text-white py-2 rounded-lg font-medium hover:bg-red-700">
                    Clear All Signups
                </button>
                <button onclick="window.open('../superadmin/new_signups.html', '_blank')" class="w-full bg-green-600 text-white py-2 rounded-lg font-medium hover:bg-green-700">
                    Open New Signups Admin Page
                </button>
                <button onclick="window.open('../website/signup.html', '_blank')" class="w-full bg-indigo-600 text-white py-2 rounded-lg font-medium hover:bg-indigo-700">
                    Open Signup Registration Page
                </button>
            </div>
        </div>

        <div class="mt-8 p-4 bg-blue-50 border border-blue-200 rounded-lg">
            <h3 class="font-bold mb-2">How to Test:</h3>
            <ol class="list-decimal list-inside space-y-1 text-sm text-gray-700">
                <li>Click "Add Test Signup" to create test signup data in localStorage</li>
                <li>Click "Open New Signups Admin Page" to view the admin interface</li>
                <li>You should see the test signup appear in the Property Owners tab</li>
                <li>Test the Verify and Reject buttons</li>
                <li>Test the search and filter functionality</li>
                <li>Or use the "Open Signup Registration Page" to create a real signup</li>
            </ol>
        </div>
    </div>

    <script>
        function createTestSignup() {
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const password = document.getElementById('password').value;

            if (!firstName || !email || !phone) {
                alert('Please fill in all fields');
                return;
            }

            const signupData = {
                id: 'user_' + Date.now(),
                firstName: firstName,
                lastName: lastName,
                email: email,
                phone: phone,
                password: password,
                createdAt: new Date().toISOString(),
                status: 'pending',
                loginId: email,
                kycStatus: 'not_submitted'
            };

            try {
                const kycTableKey = 'roomhy_kyc_verification';
                const existing = JSON.parse(localStorage.getItem(kycTableKey) || '[]');
                
                // Check if email already exists
                const emailExists = existing.some(user => user.email === email);
                if (emailExists) {
                    alert('This email is already registered');
                    return;
                }

                existing.unshift(signupData);
                localStorage.setItem(kycTableKey, JSON.stringify(existing));
                
                alert('âœ“ Test signup created successfully!\n\nEmail: ' + email);
                viewSignups();
            } catch (e) {
                alert('Error: ' + e.message);
                console.error(e);
            }
        }

        function viewSignups() {
            try {
                const kycTableKey = 'roomhy_kyc_verification';
                const signups = JSON.parse(localStorage.getItem(kycTableKey) || '[]');
                
                const output = document.getElementById('signupsList');
                if (signups.length === 0) {
                    output.textContent = 'No signups found in localStorage.\n\nCreate one using the form above or register at website/signup.html';
                } else {
                    output.textContent = JSON.stringify(signups, null, 2);
                }
            } catch (e) {
                document.getElementById('signupsList').textContent = 'Error: ' + e.message;
            }
        }

        function clearAllSignups() {
            if (confirm('Are you sure? This will delete all signup records from localStorage.')) {
                localStorage.removeItem('roomhy_kyc_verification');
                alert('All signups cleared');
                viewSignups();
            }
        }

        // Load on page load
        window.addEventListener('load', viewSignups);
    </script>
</body>
</html>
